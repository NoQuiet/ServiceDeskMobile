# ТЕХНИЧЕСКОЕ ЗАДАНИЕ
## Мобильное приложение Service Desk

---

## 1. ОБЩИЕ СВЕДЕНИЯ

### 1.1 Наименование системы
**Мобильное приложение Service Desk** - система управления заявками технической поддержки для Android.

### 1.2 Основание для разработки
Необходимость автоматизации процесса обработки заявок в службу технической поддержки с возможностью мобильного доступа.

### 1.3 Цель разработки
Создание мобильного приложения для эффективного управления заявками технической поддержки с функциями:
- Создания и отслеживания заявок
- Прикрепления фотографий к заявкам и комментариям
- Коммуникации между пользователями и специалистами
- Управления пользователями и назначения исполнителей

### 1.4 Сроки разработки
- **Начало разработки:** Декабрь 2024
- **Завершение разработки:** Декабрь 2024
- **Версия:** 1.0

---

## 2. НАЗНАЧЕНИЕ И ОБЛАСТЬ ПРИМЕНЕНИЯ

### 2.1 Назначение системы
Приложение предназначено для:
- Пользователей организации - создание и отслеживание заявок
- Специалистов технической поддержки - обработка и решение заявок
- Администраторов - управление системой и пользователями

### 2.2 Область применения
- Организации с собственной службой технической поддержки
- IT-отделы предприятий
- Helpdesk-службы
- Сервисные центры

---

## 3. ТЕХНИЧЕСКИЕ ТРЕБОВАНИЯ

### 3.1 Клиентская часть (Android приложение)

#### 3.1.1 Технологический стек
- **Язык программирования:** Kotlin
- **UI Framework:** Jetpack Compose (Material Design 3)
- **Архитектура:** MVVM (Model-View-ViewModel)
- **Минимальная версия Android:** API 24 (Android 7.0)
- **Целевая версия Android:** API 34 (Android 14)

#### 3.1.2 Основные библиотеки и зависимости
```kotlin
// Core
androidx.core:core-ktx:1.12.0
androidx.lifecycle:lifecycle-runtime-ktx:2.7.0
androidx.activity:activity-compose:1.8.2

// Compose
androidx.compose.ui:ui:1.6.0
androidx.compose.material3:material3:1.1.2
androidx.compose.material:material-icons-extended:1.6.0

// Navigation
androidx.navigation:navigation-compose:2.7.6

// Networking
com.squareup.retrofit2:retrofit:2.9.0
com.squareup.retrofit2:converter-gson:2.9.0
com.squareup.okhttp3:logging-interceptor:4.12.0

// Image Loading
io.coil-kt:coil-compose:2.5.0

// Coroutines
org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.3

// DataStore
androidx.datastore:datastore-preferences:1.0.0
```

#### 3.1.3 Структура проекта
```
app/src/main/java/com/example/servicedeskmobile/
├── data/
│   ├── api/
│   │   ├── ApiService.kt          # Retrofit API интерфейс
│   │   └── RetrofitClient.kt      # Конфигурация Retrofit
│   ├── model/
│   │   ├── User.kt                # Модели пользователей
│   │   ├── Ticket.kt              # Модели заявок
│   │   ├── Comment.kt             # Модели комментариев
│   │   └── Attachment.kt          # Модели вложений
│   └── repository/
│       ├── AuthRepository.kt      # Репозиторий аутентификации
│       ├── TicketRepository.kt    # Репозиторий заявок
│       ├── CommentRepository.kt   # Репозиторий комментариев
│       └── UserRepository.kt      # Репозиторий пользователей
├── ui/
│   ├── screen/
│   │   ├── LoginScreen.kt         # Экран входа
│   │   ├── RegisterScreen.kt      # Экран регистрации
│   │   ├── TicketListScreen.kt    # Список заявок
│   │   ├── TicketDetailScreen.kt  # Детали заявки
│   │   ├── CreateTicketScreen.kt  # Создание заявки
│   │   └── AdminScreen.kt         # Панель администратора
│   ├── viewmodel/
│   │   ├── AuthViewModel.kt       # ViewModel аутентификации
│   │   ├── TicketViewModel.kt     # ViewModel заявок
│   │   ├── CommentViewModel.kt    # ViewModel комментариев
│   │   └── UserViewModel.kt       # ViewModel пользователей
│   └── navigation/
│       └── NavGraph.kt            # Навигация приложения
├── util/
│   └── ImageUtils.kt              # Утилиты для работы с изображениями
└── MainActivity.kt                # Главная активность
```

### 3.2 Серверная часть (Backend)

#### 3.2.1 Технологический стек
- **Платформа:** Node.js v18+
- **Framework:** Express.js 4.18+
- **База данных:** MySQL 8.0+
- **Аутентификация:** JWT (JSON Web Tokens)
- **Загрузка файлов:** Multer

#### 3.2.2 Структура проекта
```
backend/
├── routes/
│   ├── auth.js          # Маршруты аутентификации
│   ├── tickets.js       # Маршруты заявок
│   ├── comments.js      # Маршруты комментариев
│   └── users.js         # Маршруты пользователей
├── middleware/
│   ├── auth.js          # Middleware аутентификации
│   └── upload.js        # Middleware загрузки файлов
├── config/
│   └── database.js      # Конфигурация БД
├── uploads/             # Директория загруженных файлов
├── .env                 # Переменные окружения
├── server.js            # Главный файл сервера
└── package.json         # Зависимости проекта
```

#### 3.2.3 Зависимости
```json
{
  "express": "^4.18.2",
  "mysql2": "^3.6.5",
  "bcrypt": "^5.1.1",
  "jsonwebtoken": "^9.0.2",
  "multer": "^1.4.5-lts.1",
  "cors": "^2.8.5",
  "dotenv": "^16.3.1"
}
```

### 3.3 База данных

#### 3.3.1 Схема базы данных

**Таблица: users**
```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    role ENUM('user', 'support', 'admin') DEFAULT 'user',
    position VARCHAR(100),
    mobile_phone VARCHAR(20),
    internal_phone VARCHAR(20),
    floor INT,
    office_number VARCHAR(20),
    is_blocked TINYINT(1) DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

**Таблица: tickets**
```sql
CREATE TABLE tickets (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(255) NOT NULL,
    description TEXT NOT NULL,
    status ENUM('new', 'in_progress', 'resolved', 'closed', 'archived') DEFAULT 'new',
    priority ENUM('low', 'medium', 'high', 'critical') DEFAULT 'medium',
    user_id INT NOT NULL,
    assigned_to INT,
    rating INT CHECK (rating >= 1 AND rating <= 5),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (assigned_to) REFERENCES users(id) ON DELETE SET NULL
);
```

**Таблица: comments**
```sql
CREATE TABLE comments (
    id INT PRIMARY KEY AUTO_INCREMENT,
    ticket_id INT NOT NULL,
    user_id INT NOT NULL,
    message TEXT NOT NULL,
    is_internal TINYINT(1) DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ticket_id) REFERENCES tickets(id) ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

**Таблица: ticket_attachments**
```sql
CREATE TABLE ticket_attachments (
    id INT PRIMARY KEY AUTO_INCREMENT,
    ticket_id INT NOT NULL,
    file_name VARCHAR(255) NOT NULL,
    file_path VARCHAR(500) NOT NULL,
    file_size INT NOT NULL,
    mime_type VARCHAR(100) NOT NULL,
    uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ticket_id) REFERENCES tickets(id) ON DELETE CASCADE
);
```

**Таблица: comment_attachments**
```sql
CREATE TABLE comment_attachments (
    id INT PRIMARY KEY AUTO_INCREMENT,
    comment_id INT NOT NULL,
    file_name VARCHAR(255) NOT NULL,
    file_path VARCHAR(500) NOT NULL,
    file_size INT NOT NULL,
    mime_type VARCHAR(100) NOT NULL,
    uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (comment_id) REFERENCES comments(id) ON DELETE CASCADE
);
```

---

## 4. ФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

### 4.1 Модуль аутентификации

#### 4.1.1 Регистрация пользователя
**Входные данные:**
- Email (обязательно, уникальный)
- Пароль (обязательно, минимум 6 символов)
- Имя (обязательно)
- Фамилия (обязательно)
- Должность (опционально)
- Мобильный телефон (опционально)
- Внутренний телефон (опционально)
- Этаж (опционально)
- Номер кабинета (опционально)

**Процесс:**
1. Валидация входных данных
2. Проверка уникальности email
3. Хеширование пароля (bcrypt)
4. Создание записи в БД с ролью 'user'
5. Генерация JWT токена
6. Возврат токена и данных пользователя

**Выходные данные:**
```json
{
  "token": "JWT_TOKEN",
  "user": {
    "id": 1,
    "email": "user@example.com",
    "firstName": "Иван",
    "lastName": "Иванов",
    "role": "user"
  }
}
```

#### 4.1.2 Вход в систему
**Входные данные:**
- Email
- Пароль

**Процесс:**
1. Поиск пользователя по email
2. Проверка блокировки (is_blocked)
3. Проверка пароля
4. Генерация JWT токена
5. Возврат токена и данных пользователя

**Коды ответов:**
- 200 - Успешный вход
- 401 - Неверный email или пароль
- 403 - Учетная запись заблокирована

#### 4.1.3 JWT токен
**Структура:**
```json
{
  "userId": 1,
  "email": "user@example.com",
  "role": "user",
  "iat": 1234567890,
  "exp": 1234654290
}
```

**Срок действия:** 24 часа

### 4.2 Модуль управления заявками

#### 4.2.1 Создание заявки
**Права доступа:** Все авторизованные пользователи

**Входные данные:**
- Заголовок (обязательно, max 255 символов)
- Описание (обязательно)
- Изображения (опционально, до 5 файлов)

**Процесс:**
1. Создание записи заявки со статусом 'new'
2. Сохранение изображений на сервер
3. Создание записей в ticket_attachments
4. Возврат ID созданной заявки

**API Endpoint:**
```
POST /api/tickets
Content-Type: application/json
Authorization: Bearer JWT_TOKEN

{
  "title": "Не работает принтер",
  "description": "Принтер в кабинете 205 не печатает документы"
}
```

**Загрузка изображений:**
```
POST /api/tickets/:id/attachments
Content-Type: multipart/form-data
Authorization: Bearer JWT_TOKEN

images: [File, File, ...]
```

#### 4.2.2 Получение списка заявок
**Права доступа:**
- user - только свои заявки
- support, admin - все заявки

**API Endpoint:**
```
GET /api/tickets
Authorization: Bearer JWT_TOKEN
```

**Ответ:**
```json
[
  {
    "id": 1,
    "title": "Не работает принтер",
    "description": "Принтер в кабинете 205...",
    "status": "new",
    "priority": "medium",
    "userId": 2,
    "firstName": "Иван",
    "lastName": "Иванов",
    "email": "ivan@example.com",
    "assignedTo": null,
    "supportFirstName": null,
    "supportLastName": null,
    "rating": null,
    "createdAt": "2024-12-19T01:00:00.000Z",
    "updatedAt": "2024-12-19T01:00:00.000Z"
  }
]
```

#### 4.2.3 Получение деталей заявки
**API Endpoint:**
```
GET /api/tickets/:id
Authorization: Bearer JWT_TOKEN
```

#### 4.2.4 Обновление статуса заявки
**Права доступа:** support, admin

**API Endpoint:**
```
PUT /api/tickets/:id/status
Authorization: Bearer JWT_TOKEN

{
  "status": "in_progress"
}
```

**Допустимые статусы:**
- new - Новая
- in_progress - В работе
- resolved - Решена
- closed - Закрыта

**Примечание:** Статус 'archived' удален из UI, но остается в БД для совместимости.

#### 4.2.5 Назначение исполнителя
**Права доступа:** admin

**API Endpoint:**
```
PUT /api/tickets/:id/assign
Authorization: Bearer JWT_TOKEN

{
  "assignedTo": 3
}
```

#### 4.2.6 Взятие заявки в работу
**Права доступа:** support

**API Endpoint:**
```
POST /api/tickets/:id/take
Authorization: Bearer JWT_TOKEN
```

**Процесс:**
1. Назначение текущего пользователя исполнителем
2. Изменение статуса на 'in_progress'

#### 4.2.7 Оценка заявки
**Права доступа:** Автор заявки

**API Endpoint:**
```
PUT /api/tickets/:id/rate
Authorization: Bearer JWT_TOKEN

{
  "rating": 5
}
```

**Ограничения:**
- Оценка от 1 до 5
- Можно оценить только один раз
- Только для заявок со статусом 'resolved' или 'closed'

#### 4.2.8 Получение вложений заявки
**API Endpoint:**
```
GET /api/tickets/:id/attachments
Authorization: Bearer JWT_TOKEN
```

**Ответ:**
```json
[
  {
    "id": 1,
    "ticketId": 1,
    "fileName": "photo1.jpg",
    "filePath": "uploads/tickets/1/photo1.jpg",
    "fileSize": 1024000,
    "mimeType": "image/jpeg",
    "uploadedAt": "2024-12-19T01:00:00.000Z"
  }
]
```

### 4.3 Модуль комментариев

#### 4.3.1 Создание комментария
**Права доступа:**
- user - к своим заявкам
- support, admin - к любым заявкам

**API Endpoint:**
```
POST /api/comments
Authorization: Bearer JWT_TOKEN

{
  "ticketId": 1,
  "message": "Проблема решена",
  "isInternal": false
}
```

**Ответ:**
```json
{
  "id": 5,
  "message": "Комментарий добавлен"
}
```

#### 4.3.2 Загрузка изображений к комментарию
**API Endpoint:**
```
POST /api/comments/:id/attachments
Content-Type: multipart/form-data
Authorization: Bearer JWT_TOKEN

images: [File, File, ...]
```

#### 4.3.3 Получение комментариев заявки
**API Endpoint:**
```
GET /api/tickets/:ticketId/comments
Authorization: Bearer JWT_TOKEN
```

**Ответ:**
```json
[
  {
    "id": 1,
    "ticketId": 1,
    "userId": 2,
    "firstName": "Иван",
    "lastName": "Иванов",
    "role": "user",
    "message": "Проблема все еще актуальна",
    "isInternal": false,
    "createdAt": "2024-12-19T01:00:00.000Z"
  }
]
```

#### 4.3.4 Получение вложений комментария
**API Endpoint:**
```
GET /api/comments/:id/attachments
Authorization: Bearer JWT_TOKEN
```

#### 4.3.5 Удаление комментария
**Права доступа:** Автор комментария

**API Endpoint:**
```
DELETE /api/comments/:id
Authorization: Bearer JWT_TOKEN
```

### 4.4 Модуль управления пользователями

#### 4.4.1 Получение списка пользователей
**Права доступа:** admin

**API Endpoint:**
```
GET /api/users
Authorization: Bearer JWT_TOKEN
```

**Ответ:**
```json
[
  {
    "id": 1,
    "email": "admin@example.com",
    "firstName": "Администратор",
    "lastName": "Системы",
    "role": "admin",
    "isBlocked": 0,
    "createdAt": "2024-12-19T01:00:00.000Z"
  }
]
```

#### 4.4.2 Получение специалистов поддержки
**Права доступа:** admin

**API Endpoint:**
```
GET /api/users/support
Authorization: Bearer JWT_TOKEN
```

#### 4.4.3 Блокировка пользователя
**Права доступа:** admin

**API Endpoint:**
```
PUT /api/users/:id/block
Authorization: Bearer JWT_TOKEN
```

#### 4.4.4 Разблокировка пользователя
**Права доступа:** admin

**API Endpoint:**
```
PUT /api/users/:id/unblock
Authorization: Bearer JWT_TOKEN
```

#### 4.4.5 Изменение роли пользователя
**Права доступа:** admin

**API Endpoint:**
```
PUT /api/users/:id/role
Authorization: Bearer JWT_TOKEN

{
  "role": "support"
}
```

**Допустимые роли:**
- user - Пользователь
- support - Специалист поддержки
- admin - Администратор

#### 4.4.6 Удаление пользователя
**Права доступа:** admin

**API Endpoint:**
```
DELETE /api/users/:id
Authorization: Bearer JWT_TOKEN
```

---

## 5. НЕФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

### 5.1 Требования к производительности
- Время отклика API: не более 2 секунд
- Время загрузки списка заявок: не более 3 секунд
- Поддержка одновременной работы до 100 пользователей

### 5.2 Требования к безопасности
- Хеширование паролей с использованием bcrypt (10 раундов)
- JWT токены с временем жизни 24 часа
- HTTPS для всех API запросов (в продакшене)
- Валидация всех входных данных
- Защита от SQL-инъекций (prepared statements)
- CORS настройка для ограничения доступа

### 5.3 Требования к надежности
- Автоматическое переподключение к БД при потере связи
- Обработка всех ошибок с информативными сообщениями
- Логирование критических операций
- Резервное копирование БД (ежедневно)

### 5.4 Требования к масштабируемости
- Возможность горизонтального масштабирования backend
- Оптимизация SQL запросов с использованием индексов
- Пагинация для больших списков данных

### 5.5 Требования к удобству использования
- Material Design 3 для единообразного UI
- Поддержка светлой и темной темы
- Адаптивный дизайн для разных размеров экранов
- Интуитивная навигация
- Информативные сообщения об ошибках

---

## 6. ТРЕБОВАНИЯ К ИЗОБРАЖЕНИЯМ

### 6.1 Ограничения
- **Максимальное количество:** 5 изображений на заявку/комментарий
- **Максимальный размер файла:** 5 МБ
- **Поддерживаемые форматы:** JPEG, JPG, PNG
- **Mime-types:** image/jpeg, image/png

### 6.2 Хранение
- **Директория:** `backend/uploads/`
- **Структура:**
  - `uploads/tickets/{ticketId}/` - изображения заявок
  - `uploads/comments/{commentId}/` - изображения комментариев
- **Именование:** `{timestamp}_{originalName}`

### 6.3 Отображение
- **URL формат:** `http://SERVER_IP:3000/uploads/{path}`
- **Превью в заявках:** 120x120 пикселей
- **Превью в комментариях:** 100x100 пикселей
- **Масштабирование:** ContentScale.Crop
- **Скругление углов:** MaterialTheme.shapes

---

## 7. ИНТЕРФЕЙС ПОЛЬЗОВАТЕЛЯ

### 7.1 Цветовая схема (Material Design 3)

**Светлая тема:**
- Primary: #6750A4
- Secondary: #625B71
- Tertiary: #7D5260
- Background: #FFFBFE
- Surface: #FFFBFE
- Error: #B3261E

**Темная тема:**
- Primary: #D0BCFF
- Secondary: #CCC2DC
- Tertiary: #EFB8C8
- Background: #1C1B1F
- Surface: #1C1B1F
- Error: #F2B8B5

### 7.2 Цвета статусов заявок
- **Новая:** #2196F3 (синий)
- **В работе:** #FF9800 (оранжевый)
- **Решена:** #4CAF50 (зеленый)
- **Закрыта:** #9E9E9E (серый)

### 7.3 Цвета приоритетов
- **Низкий:** #4CAF50 (зеленый)
- **Средний:** #FFC107 (желтый)
- **Высокий:** #FF9800 (оранжевый)
- **Критический:** #F44336 (красный)

### 7.4 Основные экраны

#### 7.4.1 Экран входа (LoginScreen)
- Иконка приложения (Settings)
- Заголовок "Service Desk"
- Поле Email
- Поле Пароль (с показом/скрытием)
- Кнопка "Войти"
- Кнопка "Регистрация"
- Кнопка "Как пользоваться?"
- Сообщения об ошибках

#### 7.4.2 Экран регистрации (RegisterScreen)
- Обязательные поля (Email, Пароль, Имя, Фамилия)
- Дополнительные поля (Должность, Телефоны, Этаж, Кабинет)
- Кнопка "Зарегистрироваться"
- Индикатор загрузки

#### 7.4.3 Список заявок (TicketListScreen)
- TopAppBar с заголовком и меню
- Фильтры (Все/Мои/Назначенные мне)
- Pull-to-refresh
- Карточки заявок с информацией
- FAB кнопка "+" для создания заявки

#### 7.4.4 Детали заявки (TicketDetailScreen)
- Информация о заявке
- Галерея изображений (если есть)
- Кнопки действий (в зависимости от роли)
- Список комментариев
- Поле ввода комментария с кнопкой добавления фото

#### 7.4.5 Создание заявки (CreateTicketScreen)
- Поле "Заголовок"
- Поле "Описание"
- Кнопка добавления фото
- Превью выбранных фото
- Кнопка "Создать заявку"

#### 7.4.6 Панель администратора (AdminScreen)
- Список пользователей
- Фильтры по роли и статусу
- Кнопки управления (Блокировка, Роль, Удаление)
- Цветовая индикация статуса

---

## 8. КОНФИГУРАЦИЯ СЕРВЕРА

### 8.1 Переменные окружения (.env)
```env
# Server
PORT=3000
NODE_ENV=development

# Database
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=servicedesk

# JWT
JWT_SECRET=your_secret_key_here
JWT_EXPIRES_IN=24h

# Upload
MAX_FILE_SIZE=5242880
MAX_FILES=5
```

### 8.2 Настройка CORS
```javascript
const corsOptions = {
  origin: '*',
  methods: ['GET', 'POST', 'PUT', 'DELETE'],
  allowedHeaders: ['Content-Type', 'Authorization']
};
```

### 8.3 Настройка Multer
```javascript
const storage = multer.diskStorage({
  destination: (req, file, cb) => {
    const uploadPath = path.join(__dirname, 'uploads', req.params.type, req.params.id);
    fs.mkdirSync(uploadPath, { recursive: true });
    cb(null, uploadPath);
  },
  filename: (req, file, cb) => {
    const uniqueName = Date.now() + '_' + file.originalname;
    cb(null, uniqueName);
  }
});

const upload = multer({
  storage: storage,
  limits: { fileSize: 5 * 1024 * 1024 },
  fileFilter: (req, file, cb) => {
    if (file.mimetype.startsWith('image/')) {
      cb(null, true);
    } else {
      cb(new Error('Only images are allowed'));
    }
  }
});
```

---

## 9. РАЗВЕРТЫВАНИЕ

### 9.1 Требования к серверу
- **ОС:** Linux (Ubuntu 20.04+) или Windows Server
- **Node.js:** v18.0.0 или выше
- **MySQL:** v8.0 или выше
- **RAM:** минимум 2 GB
- **Дисковое пространство:** минимум 10 GB
- **Сеть:** статический IP адрес

### 9.2 Установка backend

```bash
# Клонирование репозитория
git clone <repository_url>
cd backend

# Установка зависимостей
npm install

# Создание .env файла
cp .env.example .env
nano .env

# Создание базы данных
mysql -u root -p < database.sql

# Запуск сервера
npm start

# Для продакшена (с PM2)
npm install -g pm2
pm2 start server.js --name servicedesk-api
pm2 save
pm2 startup
```

### 9.3 Сборка Android приложения

```bash
# Обновление конфигурации API
# В RetrofitClient.kt изменить BASE_URL на IP сервера

# Сборка APK
cd app
./gradlew assembleRelease

# APK файл будет в:
# app/build/outputs/apk/release/app-release.apk
```

### 9.4 Настройка сетевого доступа

**Backend:**
- Открыть порт 3000 в файерволе
- Настроить переадресацию портов на роутере (если необходимо)

**Android приложение:**
- Указать IP адрес сервера в `RetrofitClient.kt`
- Текущая конфигурация: `http://192.168.1.68:3000/api/`

---

## 10. ТЕСТИРОВАНИЕ

### 10.1 Функциональное тестирование

**Модуль аутентификации:**
- ✅ Регистрация нового пользователя
- ✅ Вход с правильными данными
- ✅ Вход с неправильными данными
- ✅ Вход заблокированного пользователя
- ✅ Автоматический выход при истечении токена

**Модуль заявок:**
- ✅ Создание заявки без фото
- ✅ Создание заявки с фото (1-5 штук)
- ✅ Просмотр списка заявок
- ✅ Фильтрация заявок
- ✅ Просмотр деталей заявки
- ✅ Изменение статуса (support/admin)
- ✅ Взятие в работу (support)
- ✅ Назначение исполнителя (admin)
- ✅ Оценка заявки (user)

**Модуль комментариев:**
- ✅ Добавление комментария без фото
- ✅ Добавление комментария с фото
- ✅ Просмотр комментариев
- ✅ Отображение фото в комментариях
- ✅ Удаление своего комментария
- ✅ Очистка выбранных фото после отправки

**Модуль администрирования:**
- ✅ Просмотр списка пользователей
- ✅ Блокировка пользователя
- ✅ Разблокировка пользователя
- ✅ Изменение роли пользователя
- ✅ Удаление пользователя

### 10.2 Тестирование безопасности
- ✅ Доступ к защищенным маршрутам без токена
- ✅ Доступ с истекшим токеном
- ✅ Попытка доступа к чужим данным
- ✅ SQL-инъекции
- ✅ XSS атаки

### 10.3 Тестирование производительности
- ✅ Загрузка списка из 100+ заявок
- ✅ Загрузка изображений 5 МБ
- ✅ Одновременная работа 10+ пользователей

---

## 11. ИЗВЕСТНЫЕ ОГРАНИЧЕНИЯ

### 11.1 Текущие ограничения
1. Отсутствует пагинация для больших списков
2. Нет поиска по заявкам
3. Нет уведомлений (push notifications)
4. Нет возможности редактирования заявок
5. Нет истории изменений статусов
6. Нет экспорта отчетов
7. Нет мобильной версии для iOS

### 11.2 Планируемые улучшения
1. Добавление push-уведомлений
2. Реализация поиска и расширенной фильтрации
3. Добавление пагинации
4. Возможность редактирования заявок
5. История изменений и аудит
6. Статистика и отчеты
7. Версия для iOS
8. Web-версия приложения

---

## 12. ДОКУМЕНТАЦИЯ API

### 12.1 Базовый URL
```
http://192.168.1.68:3000/api
```

### 12.2 Аутентификация
Все защищенные маршруты требуют JWT токен в заголовке:
```
Authorization: Bearer {JWT_TOKEN}
```

### 12.3 Коды ответов
- **200** - Успешный запрос
- **201** - Ресурс создан
- **400** - Ошибка валидации
- **401** - Не авторизован
- **403** - Доступ запрещен
- **404** - Ресурс не найден
- **500** - Внутренняя ошибка сервера

### 12.4 Полный список эндпоинтов

**Аутентификация:**
- `POST /api/auth/register` - Регистрация
- `POST /api/auth/login` - Вход

**Заявки:**
- `GET /api/tickets` - Список заявок
- `GET /api/tickets/:id` - Детали заявки
- `POST /api/tickets` - Создание заявки
- `PUT /api/tickets/:id/status` - Изменение статуса
- `PUT /api/tickets/:id/assign` - Назначение исполнителя
- `POST /api/tickets/:id/take` - Взять в работу
- `PUT /api/tickets/:id/rate` - Оценить заявку
- `POST /api/tickets/:id/attachments` - Загрузить фото
- `GET /api/tickets/:id/attachments` - Получить фото

**Комментарии:**
- `GET /api/tickets/:ticketId/comments` - Список комментариев
- `POST /api/comments` - Создать комментарий
- `DELETE /api/comments/:id` - Удалить комментарий
- `POST /api/comments/:id/attachments` - Загрузить фото
- `GET /api/comments/:id/attachments` - Получить фото

**Пользователи:**
- `GET /api/users` - Список пользователей (admin)
- `GET /api/users/support` - Список специалистов (admin)
- `PUT /api/users/:id/block` - Заблокировать (admin)
- `PUT /api/users/:id/unblock` - Разблокировать (admin)
- `PUT /api/users/:id/role` - Изменить роль (admin)
- `DELETE /api/users/:id` - Удалить (admin)

---

## 13. КОНТАКТНАЯ ИНФОРМАЦИЯ

### 13.1 Разработчик
**Проект:** Service Desk Mobile  
**Версия:** 1.0  
**Дата:** Декабрь 2024

### 13.2 Техническая поддержка
Для получения технической поддержки создайте заявку в приложении.

---

## 14. ПРИЛОЖЕНИЯ

### 14.1 Глоссарий
- **JWT** - JSON Web Token, стандарт токенов доступа
- **API** - Application Programming Interface
- **MVVM** - Model-View-ViewModel, архитектурный паттерн
- **REST** - Representational State Transfer
- **CORS** - Cross-Origin Resource Sharing
- **bcrypt** - Алгоритм хеширования паролей
- **Multer** - Middleware для загрузки файлов
- **Retrofit** - HTTP клиент для Android
- **Compose** - Современный UI toolkit для Android

### 14.2 Список использованных технологий

**Frontend (Android):**
- Kotlin 1.9.0
- Jetpack Compose 1.6.0
- Material Design 3
- Retrofit 2.9.0
- Coil 2.5.0
- Coroutines 1.7.3

**Backend:**
- Node.js 18+
- Express.js 4.18
- MySQL 8.0
- JWT 9.0
- Multer 1.4
- bcrypt 5.1

---

**КОНЕЦ ДОКУМЕНТА**

**Версия:** 1.0  
**Дата актуализации:** 19.12.2024  
**Статус:** Актуальная версия
